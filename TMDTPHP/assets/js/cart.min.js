$(function(){$("body").on("click",".go-pay",function(t){if(!$("#accept-policy").is(":checked"))return alert("Bạn phải đồng ý với các điều khoản, điều kiện"),!1;if(""==$("#name").val())alert("Vui lòng nhập họ tên"),$("#name").focus();else if(""==$("#phone").val())alert("Vui lòng nhập số điện thoại"),$("#phone").focus();else if(""==$("#address").val())alert("Vui lòng nhập địa chỉ"),$("#address").focus();else{if("not checked"==$("#city").val())return alert("Vui lòng chọn tỉnh/ thành phố"),!1;if("not checked"==$("#district").val())return alert("Vui lòng chọn quận/ huyện"),!1;if("not checked"==$("#ward").val())return alert("Vui lòng chọn phường/xã"),!1}}),$("body").on("click",".method",function(t){var n=$(this).data("method"),e=$(this).parent(".method-payment-list").data("url");$(".description-method .description-info").html("Đang kiểm tra ...");var a=$(this);$(a).parent().addClass("disabled"),$.ajax({url:e,type:"POST",dataType:"JSON",data:{method:n}}).done(function(t){t.error?($(".description-method .description-info").html(""),alert(t.error)):t.success&&($("#method-payment-current").val(n),$(".description-method .description-info").html(t.success.html),$(".method.active").removeClass("active"),$(a).addClass("active"))}).fail(function(t){alert("Server bị lỗi. Vui lòng thử lại")}).always(function(){$(a).parent().removeClass("disabled")})}),$("body").on("change","input.number",function(t){$(".update-cart").removeClass("disabled"),$(this).parent().parent(".product").addClass("needupdate")}),$(".update-cart").click(function(t){t.preventDefault();for(var n=$(".product"),e=0,a=0;a<n.length;a++){var i=$(n[a]).children().nextAll(".product-price").children("span").html(),r=(i=i.replace(/,/g,""))*parseInt($(n[a]).children().nextAll(".product-quantity").children("input").val());$(n[a]).children().nextAll(".product-total").children("span").html(r.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")),e+=r}$(".cart-total-detail .temp-total .price").html(e.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")),$(".cart-total-detail .sum-total .price").html(e.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"));var c=$(this).data("url"),l=[];for(n=$(".product.needupdate"),a=0;a<n.length;a++){var o={code:$(n[a]).find('input[name="code"]').val(),num:$(n[a]).find('input[name="num"].number').val()};l.push(o)}l=JSON.stringify(l),$.ajax({url:c,type:"POST",dataType:"JSON",data:{dataupdate:l}}).done(function(t){if(t.error)alert("Xóa không thành công");else if(t.success&&($("#cart span.count").html(t.count),0==t.count)){var n="<div class='col-md-12 text-center alert alert-info'>Không có sản phẩm nào trong giỏ hàng</div>";n+='<span><a href="'+window.location.origin+'" class="btn btn-outline-success back-to-shopping">Tiếp tục mua sắm</a></span>',$(".shopping-cart>.row").html(n)}}).fail(function(){alert("Lỗi server. Vui lòng thử lại sau")}),$(this).addClass("disabled")}),$(".my-cart .remove-item-cart").click(function(t){t.preventDefault();var n=$(this).data("url"),e=$(this).prevAll("input[name='code']").val(),a=$(this);$.ajax({url:n,type:"POST",dataType:"JSON",data:{code:e}}).done(function(t){if(t.error)alert("Xóa không thành công");else if(t.success)if($("#cart span.count").html(t.count),0==t.count){var n="<div class='col-md-12 text-center alert alert-info'>Không có sản phẩm nào trong giỏ hàng</div>";n+='<span><a href="'+window.location.origin+'" class="btn btn-outline-success back-to-shopping">Tiếp tục mua sắm</a></span>',$(".shopping-cart>.row").html(n)}else $(a).parent().parent("tr.product").remove(),$(".cart-total span.price").html(t.total)}).fail(function(){alert("Lỗi server. Vui lòng thử lại sau")})}),$(".my-cart .cart-total .btn-next").click(function(t){if(!$("#security").val())return 1==confirm("Bạn phải đăng nhập để tiếp tục")&&$(".btn-frm-login").click(),!1}),$("body").on("submit","#formpayment",function(t){if(0==grecaptcha.getResponse().length)return alert("Bạn phải hoàn thành captcha bằng việc tích vào ô Tôi không phải là người máy."),!1})});
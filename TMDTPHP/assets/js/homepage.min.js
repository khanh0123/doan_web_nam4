$(function(){jQuery.event.special.touchstart={setup:function(a,e,n){if(!e.includes("noPreventDefault"))return!1;this.addEventListener("touchstart",n,{passive:!0})}};var a=0;$(document).scroll(function(e){var n=$(document).scrollTop();n>200&&0==a?($("#header>nav").addClass("fixed-top"),a=1):n<50&&1==a&&($("#header>nav").removeClass("fixed-top"),a=0)}),$("#header .search .input-search").focus(function(a){a.preventDefault(),$("#header .search").css("width","15em")}),$("#header .search .input-search").blur(function(a){a.preventDefault(),$("#header .search").css("width","9em")}),$(".backtop_dad a").click(function(a){a.preventDefault(),$("html,body").animate({scrollTop:0},500)}),$(".btn-search-submit").click(function(a){$(".form-search").submit()}),$("#formlogin").on("submit",function(a){if(a.preventDefault(),$(this).hasClass("disabled"))return alert("Vui lòng chờ..."),!1;var e=$(this).attr("action"),n=$(this).children().find("#user1").val(),t=$(this).children().find("#pwd1").val(),s=$(this).children().find(".result");if(""==n||""==t){$(s).html('<span style="color:red;">Tên tài khoản và mật khẩu không được để trống</span>')}else{$(s).html("<span style='color:green'>Đang xử lý ... </span>");var l=$(this);$(l).addClass("disabled"),$.ajax({url:e,type:"POST",dataType:"JSON",data:{login:"true",username:n,password:t}}).done(function(a){var e="";(a=a[0]).error?e='<span style="color:red;">'+a.error+"</span>":(e='<span style="color:green;">'+a.success+"</span>",location.reload()),$(s).html(e)}).fail(function(){alert("Có lỗi vui lòng thử lại sau")}).always(function(){$(l).removeClass("disabled")})}}),$("#formsignup").on("submit",function(a){if(a.preventDefault(),$(this).hasClass("disabled"))return alert("Vui lòng chờ..."),!1;var e=$(this).attr("action"),n=$(this).children().find("#user2"),t=$(this).children().find("#pwd2"),s=$(this).children().find("#pwd2_re"),l=$(this).children().find("#email2"),r=$(this).children().find(".result");if(""==$(n).val()||""==$(t).val()){var i='<span style="color:red;">Tên tài khoản và mật khẩu không được để trống</span>';$(r).html(i)}else if($(t).val()!=$(s).val()){i='<span style="color:red;">Mật khẩu nhập lại không khớp</span>';$(r).html(i)}else{var o=grecaptcha.getResponse();if(""==o){i='<span style="color:red;">Hãy hoàn thành captcha</span>';return void $(r).html(i)}$(r).html("<span style='color:green'>Đang xử lý ... </span>");var h=$(this);$(h).addClass("disabled"),$.ajax({url:e,type:"POST",dataType:"JSON",data:{adduser:"",username:$(n).val(),password:$(t).val(),repassword:$(s).val(),email:$(l).val(),"g-recaptcha-response":o}}).done(function(a){if(a.error){var e='<span style="color:red;">'+a.error+"</span>";$(r).html(e)}else if(a.success){e='<span style="color:green;">'+a.success+"</span>";$(r).html(e),$(n).val(""),$(t).val(""),$(s).val(""),$(l).val("")}}).fail(function(){$(r).html("<span style='color:red;''>Lỗi máy chủ. Vui lòng thử lại</span>")}).always(function(){grecaptcha.reset(),$(h).removeClass("disabled")})}}),$(".btn-logout").on("click",function(a){if(a.preventDefault(),$(this).hasClass("disabled"))return alert("Vui lòng chờ..."),!1;var e=$(this).data("href"),n=$(this);$(n).addClass("disabled"),$.ajax({url:e,type:"POST",dataType:"JSON",data:{logout:!0}}).done(function(a){a.error?alert("Có lỗi vui lòng thử lại sau"):window.location.href=window.location.origin}).fail(function(){alert("Có lỗi vui lòng thử lại sau")}).always(function(){$(n).removeClass("disabled")})}),$(".add-cart").click(function(a){if(a.preventDefault(),$(this).hasClass("disabled"))return alert("Vui lòng chờ..."),!1;var e=$(this).prevAll('input[name="code"]').val(),n=$(this).prevAll('input[name="color"]').val(),t=$(this).prevAll('input[name="size"]').val(),s=$(this).data("url");s||(s="./giohang/them");var l=$(this);$(l).addClass("disabled"),$.ajax({url:s,type:"POST",dataType:"JSON",data:{code:e,size:t,color:n}}).done(function(a){a.success?(alert("Thêm vào giỏ hàng thành công"),$("#cart span.count").html(a.count)):a.error&&alert("Có lỗi khi thêm vào giỏ hàng")}).fail(function(){alert("Server bị lỗi. Vui lòng thử lại sau")}).always(function(){$(l).removeClass("disabled")})}),$("body").on("submit","#formchangepass",function(a){if(a.preventDefault(),$(this).hasClass("disabled"))return alert("Vui lòng chờ..."),!1;var e=$(this).attr("action"),n=$(this).find('input[name="oldpass"]'),t=$(this).find('input[name="newpass"]'),s=$(this).find('input[name="renewpass"]'),l=$(this).find(".result");if(""==n||""==t||""==s)return alert("Hãy nhập đầy đủ thông tin"),!1;if($(t).val()!=$(s).val())return alert("Mật khẩu nhập lại không khớp"),!1;var r=$(this);$(r).addClass("disabled"),$(l).html("<span style='color:green'>Đang xử lý ... </span>"),$.ajax({url:e,type:"POST",dataType:"JSON",data:{apichangepass:"",oldpass:$(n).val(),newpass:$(t).val(),renewpass:$(s).val()}}).done(function(a){if(a.error){var e='<span style="color:red;">'+a.error+"</span>";$(l).html(e)}else if(a.success){e='<span style="color:green;">'+a.success+"</span>";$(l).html(e),$(n).val(""),$(t).val(""),$(s).val("")}}).fail(function(){$(l).html("<span style='color:red;''>Lỗi máy chủ. Vui lòng thử lại</span>")}).always(function(){$(r).removeClass("disabled")})}),$("#detail-order a.disabled").click(function(a){return a.preventDefault(),alert("Đơn hàng đã được xác nhận. Nếu muốn hủy đơn hàng vui lòng liên hệ bộ phận CSKH."),!1})});